<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Bean & Brew Customer Dashboard - Manage your orders and preferences">
    <meta name="author" content="Bean & Brew">
    <meta name="theme-color" content="#C67C4E">
    
    <title>My Dashboard - Bean & Brew</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/dashboard-new.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Poppins:wght@300;400;500;600;700&family=Cormorant+Garamond:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>

    <%- include('../partials/navbar', { page: 'dashboard', isAuthenticated: typeof isAuthenticated !== 'undefined' ? isAuthenticated : false, user: typeof user !== 'undefined' ? user : null }) %>

    <!-- Main Content Area -->
    <main class="dashboard-main">
        <div class="dashboard-wrapper">
            <!-- Navigation Cards -->
            <section class="nav-section">
                <div class="nav-cards">
                    <a href="/dashboard" class="nav-card active">
                        <div class="nav-card-icon">
                            <i class="fas fa-home"></i>
                        </div>
                        <h3 class="nav-card-title">Dashboard</h3>
                        <p class="nav-card-desc">Overview & Stats</p>
                    </a>
                    <a href="/order-history" class="nav-card">
                        <div class="nav-card-icon">
                            <i class="fas fa-history"></i>
                        </div>
                        <h3 class="nav-card-title">Order History</h3>
                        <p class="nav-card-desc">Past Orders</p>
                    </a>
                    <a href="/order-preview" class="nav-card">
                        <div class="nav-card-icon">
                            <i class="fas fa-shopping-cart"></i>
                        </div>
                        <h3 class="nav-card-title">Current Order</h3>
                        <p class="nav-card-desc">Active Order</p>
                    </a>
                    <a href="/settings" class="nav-card">
                        <div class="nav-card-icon">
                            <i class="fas fa-cog"></i>
                        </div>
                        <h3 class="nav-card-title">Settings</h3>
                        <p class="nav-card-desc">Account Settings</p>
                    </a>
                </div>
            </section>

            <!-- Page Header -->
            <header class="page-header">
                <div class="header-left">
                    <h1 class="page-title">
                        Good <%= new Date().getHours() < 12 ? 'Morning' : new Date().getHours() < 18 ? 'Afternoon' : 'Evening' %>,
                        <% if (user && user.firstName) { %>
                            <%= user.firstName %>!
                        <% } else { %>
                            Valued Customer!
                        <% } %>
                    </h1>
                    <p class="page-subtitle">Welcome back to Bean & Brew</p>
                </div>
                <% if (user && !user.isVerified) { %>
                <div class="verification-alert">
                    <i class="fas fa-exclamation-circle"></i>
                    <span>Please verify your email to unlock all features</span>
                </div>
                <% } %>
            </header>

            <!-- Stats Grid -->
            <section class="stats-section">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-shopping-bag"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Total Orders</p>
                        <h3 class="stat-number" id="totalOrders">0</h3>
                        <span class="stat-desc">All time purchases</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Cart Items</p>
                        <h3 class="stat-number" id="cartItems">0</h3>
                        <span class="stat-desc">Ready to checkout</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-peso-sign"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Total Spent</p>
                        <h3 class="stat-number" id="totalSpent">â‚±0</h3>
                        <span class="stat-desc">Completed orders</span>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <p class="stat-label">Pending Orders</p>
                        <h3 class="stat-number" id="pendingOrders">0</h3>
                        <span class="stat-desc">In progress</span>
                    </div>
                </div>
            </section>

            <!-- Content Cards Grid -->
            <section class="content-grid">
                <!-- Recent Orders Card -->
                <div class="content-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-receipt"></i> Recent Orders
                        </h2>
                        <a href="/order-history" class="card-link">View All</a>
                    </div>
                    <div class="card-body">
                        <div class="orders-list" id="recentOrdersList">
                            <div class="empty-state">
                                <i class="fas fa-coffee"></i>
                                <p>No orders yet</p>
                                <a href="/menu" class="btn-primary">Browse Menu</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Cart Preview Card -->
                <div class="content-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-shopping-cart"></i> Your Cart
                        </h2>
                        <a href="/cart" class="card-link">View Cart</a>
                    </div>
                    <div class="card-body">
                        <div class="cart-preview" id="cartPreview">
                            <div class="empty-state">
                                <i class="fas fa-cart-plus"></i>
                                <p>Your cart is empty</p>
                                <a href="/menu" class="btn-primary">Start Shopping</a>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Account Info Card -->
                <div class="content-card">
                    <div class="card-header">
                        <h2 class="card-title">
                            <i class="fas fa-user-circle"></i> Account Information
                        </h2>
                        <a href="/settings" class="card-link">Edit Profile</a>
                    </div>
                    <div class="card-body">
                        <div class="account-info">
                            <div class="info-item">
                                <i class="fas fa-user"></i>
                                <div class="info-content">
                                    <label>Full Name</label>
                                    <p><%= user && user.firstName && user.lastName ? `${user.firstName} ${user.lastName}` : 'Not set' %></p>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-envelope"></i>
                                <div class="info-content">
                                    <label>Email Address</label>
                                    <p><%= user && user.email ? user.email : 'Not set' %></p>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-phone"></i>
                                <div class="info-content">
                                    <label>Phone Number</label>
                                    <p><%= user && user.phone ? user.phone : 'Not set' %></p>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-shield-alt"></i>
                                <div class="info-content">
                                    <label>Account Status</label>
                                    <p>
                                        <% if (user && user.isVerified) { %>
                                            <span class="badge verified"><i class="fas fa-check-circle"></i> Verified</span>
                                        <% } else { %>
                                            <span class="badge unverified"><i class="fas fa-exclamation-circle"></i> Unverified</span>
                                        <% } %>
                                    </p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Bottom Navigation (Mobile) -->
    <%- include('../partials/generalBottomNav', { page: 'dashboard' }) %>

    <script src="/js/auth/logout.js"></script>
    <script src="/js/auth/userProfile.js"></script>
    <script src="/js/user/dashboard.js"></script>
</body>
</html>
