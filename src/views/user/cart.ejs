<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="theme-color" content="#C67C4E">
	<title>My Cart - Bean & Brew</title>
	<link rel="stylesheet" href="/css/styles.css">
	<link rel="stylesheet" href="/css/cart.css">
	<!-- Bootstrap CSS (only for modals and toasts) -->
	<style>
		/* Only apply Bootstrap styles to modals and toasts - prevent conflicts with existing styles */
		.modal, .modal * {
			box-sizing: border-box;
		}
		
		.toast, .toast * {
			box-sizing: border-box;
		}
		
		/* Ensure modals and toasts use Bootstrap positioning */
		.modal-backdrop {
			position: fixed;
			top: 0;
			left: 0;
			z-index: 1040;
			width: 100vw;
			height: 100vh;
			background-color: #000;
		}
		
		.modal-backdrop.show {
			opacity: 0.5;
		}
		
		.modal {
			position: fixed;
			top: 0;
			left: 0;
			z-index: 1055;
			display: none;
			width: 100%;
			height: 100%;
			overflow-x: hidden;
			overflow-y: auto;
			outline: 0;
		}
		
		.modal.show {
			display: block;
		}
		
		.modal-dialog {
			position: relative;
			width: auto;
			margin: 1.75rem auto;
			max-width: 500px;
		}
		
		.modal-dialog-centered {
			display: flex;
			align-items: center;
			min-height: calc(100% - 3.5rem);
		}
		
		.modal-content {
			position: relative;
			display: flex;
			flex-direction: column;
			width: 100%;
			pointer-events: auto;
			background-color: #fff;
			background-clip: padding-box;
			border: 1px solid rgba(0, 0, 0, 0.2);
			outline: 0;
		}
		
		.modal-header {
			display: flex;
			flex-shrink: 0;
			align-items: center;
			justify-content: space-between;
		}
		
		.modal-title {
			margin-bottom: 0;
			line-height: 1.5;
		}
		
		.modal-body {
			position: relative;
			flex: 1 1 auto;
		}
		
		.modal-footer {
			display: flex;
			flex-wrap: wrap;
			flex-shrink: 0;
			align-items: center;
			justify-content: flex-end;
			gap: 0.5rem;
		}
		
		/* Only apply button styles within modals */
		.modal .btn {
			display: inline-block;
			font-weight: 400;
			line-height: 1.5;
			text-align: center;
			text-decoration: none;
			vertical-align: middle;
			cursor: pointer;
			user-select: none;
			border: 1px solid transparent;
			transition: color 0.15s ease-in-out, background-color 0.15s ease-in-out, border-color 0.15s ease-in-out, box-shadow 0.15s ease-in-out;
		}
		
		.modal .btn-secondary {
			color: #fff;
			background-color: #6c757d;
			border-color: #6c757d;
		}
		
		.modal .btn-secondary:hover {
			background-color: #5c636a;
			border-color: #565e64;
		}
		
		.modal .btn-danger {
			color: #fff;
			background-color: #dc3545;
			border-color: #dc3545;
		}
		
		.modal .btn-danger:hover {
			background-color: #bb2d3b;
			border-color: #b02a37;
		}
		
		.modal .btn-close,
		.toast .btn-close {
			box-sizing: content-box;
			width: 1em;
			height: 1em;
			padding: 0.25em;
			color: #000;
			background: transparent url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16' fill='%23000'%3e%3cpath d='M.293.293a1 1 0 0 1 1.414 0L8 6.586 14.293.293a1 1 0 1 1 1.414 1.414L9.414 8l6.293 6.293a1 1 0 0 1-1.414 1.414L8 9.414l-6.293 6.293a1 1 0 0 1-1.414-1.414L6.586 8 .293 1.707a1 1 0 0 1 0-1.414z'/%3e%3c/svg%3e") center/1em auto no-repeat;
			border: 0;
			opacity: 0.5;
			cursor: pointer;
		}
		
		.modal .btn-close:hover,
		.toast .btn-close:hover {
			opacity: 0.75;
		}
		
		.toast {
			max-width: 350px;
			overflow: hidden;
			font-size: 0.875rem;
			background-color: rgba(255, 255, 255, 0.85);
			background-clip: padding-box;
			border: 1px solid rgba(0, 0, 0, 0.1);
			box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15);
			border-radius: 0.25rem;
		}
		
		.toast:not(.show) {
			display: none;
		}
		
		.toast.show {
			display: block;
		}
		
		.toast-header {
			display: flex;
			align-items: center;
			padding: 0.5rem 0.75rem;
			color: #6c757d;
			background-color: rgba(255, 255, 255, 0.85);
			background-clip: padding-box;
			border-bottom: 1px solid rgba(0, 0, 0, 0.05);
		}
		
		.toast-body {
			padding: 0.75rem;
			word-wrap: break-word;
		}
		
		/* Utility classes - scoped to toast container */
		.toast-container.position-fixed {
			position: fixed !important;
		}
		
		.toast-container.bottom-0 {
			bottom: 0 !important;
		}
		
		.toast-container.end-0 {
			right: 0 !important;
		}
		
		.toast-container.p-3 {
			padding: 1rem !important;
		}
		
		/* Utility classes for modal and toast content */
		.modal .d-flex,
		.toast .d-flex {
			display: flex !important;
		}
		
		.modal .me-auto,
		.toast .me-auto {
			margin-right: auto !important;
		}
		
		.modal .me-2,
		.toast .me-2 {
			margin-right: 0.5rem !important;
		}
		
		.modal .text-success,
		.toast .text-success {
			color: #28a745 !important;
		}
		
		.modal .text-warning,
		.toast .text-warning {
			color: #ffc107 !important;
		}
		
		.modal .text-danger,
		.toast .text-danger {
			color: #dc3545 !important;
		}
		
		.modal .text-info,
		.toast .text-info {
			color: #17a2b8 !important;
		}
		
		/* Fade transitions for modals */
		.modal.fade,
		.toast.fade {
			transition: opacity 0.15s linear;
		}
		
		.modal.fade:not(.show),
		.toast.fade:not(.show) {
			opacity: 0;
		}
		
		.modal.fade.show,
		.toast.fade.show {
			opacity: 1;
		}
	</style>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
	<meta name="description" content="Review your selected coffee items, update quantities, and proceed to checkout.">
	<meta name="keywords" content="coffee cart, checkout, bean and brew, orders">
</head>
<body>
	<!-- Animated Background Elements -->
	<div class="background-animation">
		<div class="coffee-bean bean-1"></div>
		<div class="coffee-bean bean-2"></div>
		<div class="coffee-bean bean-3"></div>
		<div class="coffee-bean bean-4"></div>
		<div class="coffee-bean bean-5"></div>
		<div class="steam steam-1"></div>
		<div class="steam steam-2"></div>
		<div class="steam steam-3"></div>
	</div>

	<%- include('../partials/navbar', { page: 'cart' }) %>

	<main class="cart-page">
		<div class="container">
            <header class="cart-header">
                <div class="ch-left">
                    <h1><span class="ch-icon">ðŸ§º</span> Your Cart</h1>
                    <p class="ch-sub">Warm up your day â€” review items, adjust quantities, and brew the perfect order.</p>
                </div>
                <div class="ch-right">
                    <button class="edit-cart-btn" id="editCartBtn">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="delete-selected-btn" id="deleteSelectedBtn" style="display: none;">
                        <i class="fas fa-trash"></i> Delete Selected
                    </button>
                    <button class="cancel-edit-btn" id="cancelEditBtn" style="display: none;">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </header>
			
			<section class="cart-grid">
				<!-- Cart Items -->
				<div class="cart-items cart-card">
					<!-- Empty cart message -->
					<div id="emptyCartMessage" style="display: none; text-align: center; padding: 60px 20px;">
						<i class="fas fa-shopping-cart" style="font-size: 64px; color: #ddd; margin-bottom: 20px;"></i>
						<h3 style="color: #666; margin-bottom: 10px;">Your cart is empty</h3>
						<p style="color: #999; margin-bottom: 20px;">Add some delicious coffee to get started!</p>
						<a href="/menu" style="display: inline-block; background: var(--brew-primary); color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none;">
							Browse Menu
						</a>
					</div>
					
					<!-- Cart items container -->
					<div id="cartItemsContainer">
						<!-- Items will be rendered here by JavaScript -->
						<div style="text-align: center; padding: 40px;">
							<i class="fas fa-spinner fa-spin" style="font-size: 48px; color: var(--brew-primary);"></i>
							<p style="color: #999; margin-top: 16px;">Loading cart...</p>
						</div>
					</div>
				</div>

				<!-- Order Summary -->
				<aside class="order-summary cart-card">
					<h2 class="os-title">Order Summary</h2>
					
					<div class="order-info" style="margin-bottom: 20px; padding: 12px; background: rgba(198, 124, 78, 0.05); border-radius: 8px;">
						<p style="margin: 0; color: #666; font-size: 0.9rem;">
							<i class="fas fa-shopping-bag"></i> 
							<span id="itemCount">0</span> item(s) selected
						</p>
					</div>

					<div class="order-totals">
						<div class="total-row"><span>Subtotal</span><span id="cartSubtotal">â‚±0.00</span></div>
						<div class="total-row"><span>Tax (2%)</span><span id="cartShipping">â‚±0.00</span></div>
					</div>

					<div class="total-main">
						<span>Total</span>
						<span id="cartTotal">â‚±0.00</span>
					</div>

				<button class="checkout-btn" id="checkoutBtn" aria-label="Proceed to checkout">
					Proceed to Checkout
				</button>

				<a href="/menu" class="continue-shopping-link"><i class="fas fa-arrow-left"></i> Continue Shopping</a>

				<p class="fine-print">By checking out, you agree to our Terms and Privacy Policy.</p>
			</aside>
			</section>
		</div>
	</main>

	<!-- Back to Top Button -->
	<button class="back-to-top" id="backToTop" onclick="scrollToTop()" aria-label="Back to top">
		<svg width="24" height="24" viewBox="0 0 24 24" fill="none" aria-hidden="true">
			<path d="M12 19V5M5 12L12 5L19 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
		</svg>
	</button>

	<!-- Bottom Navigation (Mobile) -->
	<%- include('../partials/generalBottomNav', { page: 'cart' }) %>

	<!-- Bootstrap JS for Toast -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
	<!-- Cart JavaScript -->
	<script src="/js/user/cart.js"></script>
</body>
</html>
